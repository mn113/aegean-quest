<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Aegean Quest</title>
	<link href="https://fonts.googleapis.com/css?family=Flamenco|GFS+Neohellenic|Lancelot" rel="stylesheet">
	<link rel="stylesheet" href="css/map.css">
	<link rel="stylesheet" href="css/ui.css">
	<link rel="stylesheet" href="js/dataarts/dat.gui.css">
	<script src="js/dataarts/dat.gui.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link rel="stylesheet" href="css/semantic/semantic.css">
	<script src="css/semantic/semantic.js"></script>
	<script src="js/gameText.js"></script>
	<script type="text/javascript" src="http://canvg.github.io/canvg/rgbcolor.js"></script>
	<script type="text/javascript" src="http://canvg.github.io/canvg/StackBlur.js"></script>
	<script type="text/javascript" src="http://canvg.github.io/canvg/canvg.js"></script>
</head>
<body>
	<h1>Aegean Quest</h1>

	<div id="post-fifth"></div>

	<div id="gamearea">
		<div id="not-ui">
			<div id="fifth">
				<svg id="gamesvg" width="800" height="600" viewBox="0 0 800 600">
					<defs>
						<style type="text/css">
						.clickable {
							cursor: pointer;
						}
						circle.sea {
							fill: white !important;
						}
						circle.land {
							fill: black !important;
						}
						</style>
					</defs>
					<g id="container"></g>
				</svg>
				<!--img class="compass" src="img/compass.png"-->
			</div>
			<div class="greek_banner top">&nbsp;</div>
			<div class="greek_banner bottom">&nbsp;</div>
		</div>

		<div id="ui">
			<button class="ui icon button left static massive inverted orange">
				<img src="img/trireme-icon.png" width="50">
			</button>
			<button class="ui icon button right static massive inverted orange">
				<i class="black university icon"></i>
			</button>

			<div class="ui left demo vertical inverted sidebar labeled icon menu thin visible">
				<a class="ui message close inverted">
					<i class="close icon"></i>
				</a>
				<a class="item" id="ship-ui"><!-- ship stats render here -->
				</a>
			</div>
			<div class="ui right demo vertical inverted sidebar labeled icon menu visible">
				<a class="ui message close inverted">
					<i class="close icon"></i>
				</a>
				<a class="item">
					Time...
				</a>
				<a class="item">
					<div class="yellow inverted statistic">
						<div class="value" id="gold-ui">100</div>
						<div class="label">Gold</div>
					</div>
				</a>
				<a class="item">
					Trophies
					<div id="trophies-ui">
					</div>
				</a>
				<a class="item">
					Gods
					<div id="gods-ui">
					</div>
				</a>
			</div>
			<div class="pusher">
				<!--div class="ui segment" id="game-loader">
					<div class="ui indeterminate text loader">Generating ancient world</div>
				</div-->
			</div>
		</div>
	</div>

	<div class="ui floating labeled icon dropdown button">
		<span class="text">Buy...</span>
		<div class="menu">
			<div class="header">
				<i class="tags icon"></i>
				Buy
			</div>
			<div class="divider"></div>
			<div class="item">
				<i class="attention icon"></i>
				Wine
			</div>
			<div class="item">
				<i class="comment icon"></i>
				Bread
			</div>
			<div class="item">
				<i class="conversation icon"></i>
				Chicken
			</div>
		</div>
	</div>

	<div class="ui floating labeled icon dropdown button">
		<span class="text">Sell...</span>
		<div class="menu">
			<div class="header">
				<i class="tags icon"></i>
				Buy
			</div>
			<div class="divider"></div>
			<div class="item">
				<i class="attention icon"></i>
				Wine
				<div class="menu">
					<div class="item">1 flagon</div>
					<div class="item">5 flagons</div>
					<div class="item">10 flagons</div>
				</div>
			</div>
			<div class="item">
				<i class="comment icon"></i>
				Bread
				<div class="menu">
					<div class="item">1 tray</div>
					<div class="item">5 trays</div>
					<div class="item">10 trays</div>
				</div>
			</div>
			<div class="item">
				<i class="conversation icon"></i>
				Chicken
				<div class="menu">
					<div class="item">1 batch</div>
					<div class="item">5 batches</div>
					<div class="item">10 batches</div>
				</div>
			</div>
		</div>
	</div>

	<!-- end of HTML content -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>
	<script src="js/adamhooper/priority-queue.min.js"></script>
	<script src="js/julianbrowne/ShortestPathCalculator.js"></script>
	<script src="js/julianbrowne/ShortestPathUtils.js"></script>
	<script src="js/mourner/simplify.js"></script>
	<script src="js/mewo2/terrain.js"></script>
	<script src="js/mewo2/terraincontrols.js"></script>
	<script src="js/islands.js"></script>
	<script src="js/classes.js"></script>
	<script src="js/game.js"></script>
	<script type="text/javascript">

		var towns = [];	// game global?

		var FizzyText = function() {
			this.shipName = player.ships[0].name;
			this.poseidon = 0.8;
			this.uranus = -1.5;
			this.demeter = 0;
			this.newTown = function() {		// ok
				var t = new Town();
				towns.push(t);
				console.log(t);
			};
			this.newShip = function() {
				players.ships.push(new Ship());
				// re-render sidebar
			};
			this.newSailor = function() {
				var currentShip = player.ships[0];
				currentShip.addCrew(new Sailor());
				ui.renderShip(currentShip);
			};
			this.showHidePoints = function() {
				$("#visualizedPoints").toggle();	// ok
			};
			this.toggleSidebar = function() {
				$('.ui.labeled.icon.sidebar').sidebar('toggle');
			};
			this.visitTown = function() {
				towns[0].peaceTimeEvent();
			};
			this.visitSea = function() {
				ui.makeModal(seaEvent());
			};
			this.insufficient = function() {
				ui.renderPopup({
					title: "Sorry",
					content: "You don't have sufficient men to sail. You should hire more men.",
					buttons: {no: "OK"}
				});
			}
			this.godlike = function() {
				ui.godReaction("Uranus", 1);
			};
		};

		window.onload = function() {
			var text = new FizzyText();
			var gui = new dat.GUI();
			gui.add(text, 'shipName');
			var f1 = gui.addFolder('Gods');
			f1.add(text, 'poseidon', -5, 5);	// range
			f1.add(text, 'uranus', -5, 5);		// range
			f1.add(text, 'demeter', -5, 5);		// range
			var f2 = gui.addFolder('Functions');
			f2.add(text, 'newTown');	// button
			f2.add(text, 'newShip');	// button
			f2.add(text, 'newSailor');	// button
			f2.add(text, 'visitTown');	// button
			f2.add(text, 'visitSea');	// button
			f2.add(text, 'insufficient'); // button
			f2.add(text, 'godlike'); // button
			var f3 = gui.addFolder('UI');
			f3.add(text, 'showHidePoints');	// button
			f3.add(text, 'toggleSidebar');	// button
			gui.close();
		};

		// Semantic UI setup:
		$('.ui.sidebar')
		.sidebar({
			context: $('#ui'),
			dimPage: false,
			transition: "overlay"
		});
		// Open & close buttons:
		var $left_sb = $('.left.sidebar');
		var $right_sb = $('.right.sidebar');
		$left_sb.sidebar('attach events', '.left a.close', 'close');
		$left_sb.sidebar('attach events', '#ui > .button.left', 'open');
		$right_sb.sidebar('attach events', '.right a.close', 'close');
		$right_sb.sidebar('attach events', '#ui > .button.right', 'open');

		// Crew tooltips:
		$('#gamearea .ui .crew img').popup();

		function svgToCanvas() {
			// NOT IN USE
			var svgString = $("#fifth").html();
			console.log(svgString);
			//load a svg snippet in the canvas with id = 'drawingArea'
			canvg(document.querySelector('#canvas'), svgString, {});
		}

	</script>
</body>
<html>
